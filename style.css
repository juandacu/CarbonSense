/* ========== Base ========== */
:root{
  --bg:#ffffff;
  --text:#141414;
  --muted:#666;
  --border:#e6e6e6;
  --accent:#1b7f6b;                /* site accent */
  --accent-soft: rgba(27,127,107,.10);
  --accent-border: rgba(27,127,107,.55);
  --container:1200px;
  --radius:16px;
  --shadow:0 8px 24px rgba(0,0,0,.08);
  --shadow-hover:0 14px 34px rgba(0,0,0,.12);
  --space-section:6rem;
  --gutter:24px;
}

*{box-sizing:border-box}
html,body{margin:0;padding:0}
html, body { overflow-x: hidden; }
body{
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  color:var(--text);
  background:var(--bg);
  line-height:1.6;
}

/* ========== Typography ========== */
h1,h2,h3{
  font-family:"Playfair Display", Georgia, "Times New Roman", serif;
  line-height:1.2; margin:0 0 1rem;
}
h1{font-size:clamp(2rem,3.5vw,3.25rem)}
h2{font-size:clamp(1.5rem,2.5vw,2.25rem)}
h3{font-size:1.25rem}
.lead{font-size:1.125rem; color:var(--muted)}

/* ========== Layout ========== */
.container{max-width:var(--container); margin:0 auto; padding:0 var(--gutter)}
.section{padding:var(--space-section) 0}

/* ========== Header ========== */
.site-header{
  position: sticky;
  top: 0;
  z-index: 1000;
  height: 72px;
  background: transparent;
  transition: background .25s, box-shadow .25s, color .25s;
}
.site-header.scrolled{
  background: #0b0b0b08;
  backdrop-filter: saturate(140%) blur(6px);
  box-shadow: 0 1px 0 rgba(0,0,0,.08);
}
.site-header.transparent{background:transparent}
.site-header.solid{
  background:rgba(255,255,255,.9);
  backdrop-filter:saturate(180%) blur(10px);
  border-color:var(--border)
}
.header-inner{display:flex; align-items:center; justify-content:space-between; height:72px}
.logo{font-weight:600; letter-spacing:.2px; text-decoration:none; color:var(--text)}
.logo img { height: 100px; width: auto; display: block; }
.nav{display:flex; gap:22px; align-items:center}
.nav a{color:var(--text); text-decoration:none; font-weight:500}
.nav a.active{opacity:.7}

/* Mobile nav */
.hamburger{display:none; background:none; border:0; padding:8px; cursor:pointer}
.hamburger span{display:block; width:22px; height:2px; background:#000; margin:5px 0; transition:transform .2s ease, opacity .2s ease}
@media (max-width: 880px){
  .nav{position:fixed; inset:72px 0 auto 0; background:#fff; border-top:1px solid var(--border); display:none; flex-direction:column; padding:18px}
  .nav.open{display:flex}
  .hamburger{display:block}
}

/* ========== Buttons ========== */
.btn{display:inline-flex; align-items:center; justify-content:center; padding:10px 18px; font-weight:600; text-decoration:none}
.pill{border-radius:999px}
.btn-outline{border:1.5px solid var(--text); color:var(--text); background:transparent}
.btn-outline:hover{box-shadow:var(--shadow)}

/* ========== Generic Cards/Grid ========== */
.grid{display:grid; gap:24px}
.cards-3{grid-template-columns:repeat(3, 1fr)}
@media (max-width: 920px){ .cards-3{grid-template-columns:1fr 1fr} }
@media (max-width: 640px){ .cards-3{grid-template-columns:1fr} }

.card{
  border:1px solid var(--border); border-radius:var(--radius);
  padding:24px; text-decoration:none; color:inherit; background:#fff;
}
.card.hover{transition:transform .25s ease, box-shadow .25s ease, border-color .25s ease}
.card.hover:hover{transform:translateY(-3px); box-shadow:var(--shadow-hover)}

/* ========== Prose ========== */
.prose p{margin:0 0 1rem}
.prose h2{margin-top:2rem}

/* Improved article typography and width */
.prose.docx {
  --prose-max: 72ch;
  max-width: var(--prose-max);
  margin-inline: auto;
}
.prose.docx h1, .prose.docx h2, .prose.docx h3, .prose.docx h4 {
  font-family:"Playfair Display", Georgia, "Times New Roman", serif;
  line-height:1.2; margin:2rem 0 1rem;
}
.prose.docx h1 { font-size: clamp(2rem, 3.2vw, 3rem); }
.prose.docx h2 { font-size: clamp(1.5rem, 2.4vw, 2.25rem); }
.prose.docx h3 { font-size: clamp(1.25rem, 1.8vw, 1.5rem); }
.prose.docx p, .prose.docx li { font-size: 1.05rem; color: var(--text); }
.prose.docx ul, .prose.docx ol { padding-left: 1.2rem; margin: 0 0 1rem; }
.prose.docx blockquote {
  border-left: 3px solid var(--border);
  padding-left: 1rem;
  color: var(--muted);
  margin: 1.25rem 0;
}
.prose.docx img { max-width: 100%; height: auto; border-radius: 8px; }
.prose.docx a { color: inherit; text-decoration: underline; text-underline-offset: 2px; }

/* ========== Responsive embeds & plot iframes ========== */
.embed {
  width: 100%;
  height: clamp(360px, 62vh, 760px);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  background: #fff;
  box-shadow: var(--shadow);
  margin: 1.5rem 0;
}
.embed > iframe { width: 100%; height: 100%; border: 0; display: block; }

/* Plot iframes (auto width within container) */
.prose.docx iframe.plot-embed{
  display:block;
  max-width:100%;
  width:100%;
  border:0;
  margin: 1rem 0;
}

/* Optional full-bleed embeds within prose (kept for flexibility) */
.prose.docx .embed.full-bleed {
  width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
  border-left: 0; border-right: 0; border-radius: 0;
}
@media (min-width: 900px) {
  .prose.docx .embed.full-bleed {
    width: min(100vw, var(--container));
    margin-left: calc((min(100vw, var(--container)) - 100vw) / 2 * -1);
    border-radius: var(--radius);
    border-left: 1px solid var(--border);
    border-right: 1px solid var(--border);
  }
}

/* ========== Forms ========== */
.form-card{
  max-width:640px; border:1px solid var(--border); border-radius:var(--radius);
  padding:24px; background:#fff; box-shadow:var(--shadow)
}
.field{display:flex; flex-direction:column; gap:8px; margin-bottom:16px}
input, textarea{
  width:100%; padding:12px 14px; border:1px solid var(--border);
  border-radius:12px; font:inherit
}
input:focus, textarea:focus{outline:none; border-color:#bbb}

/* ========== Footer ========== */
.site-footer{border-top:1px solid var(--border); margin-top:64px}
.footer-inner{
  display:grid; gap:24px; grid-template-columns:2fr 1fr 1fr;
  padding:32px 0;
}
.foot-title{font-weight:600; margin-bottom:8px}
.foot-links{list-style:none; padding:0; margin:0}
.foot-links li{margin:6px 0}
.muted{color:var(--muted); margin:8px 0 0}
.foot-bottom{display:flex; align-items:center; justify-content:space-between; padding:16px 0; border-top:1px solid var(--border)}
.site-footer .logo img{ height: 24px; }

/* ========== Scroll reveal ========== */
[data-animate]{opacity:0; transform:translateY(16px); transition:opacity .6s ease, transform .6s ease}
[data-animate].in{opacity:1; transform:none}

/* ========== Hero (image/video) ========== */
.page-hero{
  position: relative;
  isolation: isolate;
  overflow: hidden;
  padding-block: clamp(72px, 12vh, 120px) clamp(48px, 10vh, 96px);
  min-height: clamp(420px, 72vh, 760px);
  color: #fff;
}
.page-hero .hero-bg{
  position: absolute; inset: 0; z-index: -1; pointer-events: none;
}

.hero-title{ margin: 0 0 .75rem; line-height: 1.05; color:#fff; }
.hero-sub{ color: rgba(255,255,255,.85); margin: 0 0 1.25rem; }
.hero-ctas .btn.btn-outline{ color:#fff; border:1.5px solid #fff; background: transparent; }
.hero-ctas .btn.btn-outline:hover{ background: rgba(255,255,255,.14); }

/* Hero media layout */
.hero-media { position: relative; padding: 0; }
.hero-media .hero-bg{
  position:absolute; inset:0;
  background:radial-gradient(80% 60% at 20% 20%, rgba(24,83,67,.55), transparent 60%), #0b0f0e;
}
.hero-inner{
  position: relative;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 36px;
  align-items: center;
  min-height: clamp(640px, 85vh, 900px);
  padding: 96px 0;
}
.hero-copy{ color:#eaf3ef; }
.hero-value{ margin: 0 0 16px; color:#bdd3cb; }
.hero-ctas{ display:flex; gap:12px; margin-top:12px; }

.hero-media-frame{
  justify-self: end;
  width: min(48vw, 860px);
  background:#0e1a17;
  border:1px solid rgba(255,255,255,.14);
  border-radius:16px;
  padding:12px;
  box-shadow: 0 30px 60px rgba(0,0,0,.35);
}
.hero-media-frame img, .hero-media-frame video{
  display:block; width:100%; height:auto; border-radius:12px; object-fit: cover; aspect-ratio: 16 / 10;
}
.hero-media-frame figcaption{ margin-top:6px; color:#a8c1b8; font-size:.9rem; }

/* Carousel */
.hero-carousel{
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 10;
  overflow: hidden;
  border-radius: 12px;
}
.hero-carousel .slide{
  position: absolute; inset: 0; opacity: 0;
  transition: opacity .8s ease;
}
.hero-carousel .slide.is-active{ opacity: 1; }
.hero-carousel .slide > img,
.hero-carousel .slide > video{
  width: 100%; height: 100%; object-fit: cover; display: block; border-radius: 12px;
}

/* Mobile hero fixes */
@media (max-width: 980px){
  .hero-inner{ grid-template-columns: 1fr; gap: 18px; padding: 56px 0; }
  .hero-media-frame{ justify-self: stretch; width: 100% !important; margin: 0; }
  .hero-carousel{ aspect-ratio: unset; height: clamp(220px, 46vh, 420px); }
  .hero-carousel .slide,
  .hero-carousel video,
  .hero-carousel img{
    width: 100%; height: 100%; object-fit: cover; border-radius: 12px;
  }
}

/* Compact hero variant for inner pages */
.page-hero.hero-compact{
  min-height: auto;
  padding-block: 36px 20px;
  color: var(--text);
}
.page-hero.hero-compact .lead{ color: var(--muted); }

/* ========== Articles listing ========== */
.articles-hero{
  background:
    radial-gradient(60% 70% at 0% 0%, rgba(27,127,107,.22), transparent 60%),
    linear-gradient(180deg, #0f1715 0%, #0c0f0e 100%);
  color:#e7f1ed;
  padding: 36px 0 32px;
  border-bottom: 1px solid rgba(255,255,255,.06);
}
.articles-hero h1{ color:#fff; margin:0 0 6px; }
.articles-hero .lead{ color:#c7dbd4; margin:0; }

.article-grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(280px,1fr));
  gap:18px;
}
.article-card{
  display:grid;
  grid-template-rows:auto 1fr auto;
  background:#fff;
  border:1px solid var(--border);
  border-radius:16px;
  overflow:hidden;
  box-shadow: var(--shadow);
  transition: transform .16s ease, box-shadow .16s ease, border-color .16s ease;
}
.article-card:hover{ transform: translateY(-2px); box-shadow: 0 18px 38px rgba(0,0,0,.12); border-color:#dfe7e4; }
.article-thumb{ aspect-ratio: 16/9; width:100%; object-fit:cover; display:block; background:#f3f6f5; }
.article-body{ padding:14px 14px 0; }
.article-body h3{ margin:0 0 6px; font-size:1.05rem; line-height:1.3; }
.article-deck{ margin:0; color:#4a5552; font-size:.95rem; }
.article-meta{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; padding:12px 14px 14px;
}
.meta-left{ display:flex; align-items:center; gap:8px; min-width:0; }
.meta-left img{ width:28px; height:28px; border-radius:50%; object-fit:cover; border:1px solid #e9eeec; }
.meta-left .byline{ font-size:.92rem; color:#2a2f2e; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.meta-right{ display:flex; align-items:center; gap:8px; color:#6b7471; font-size:.9rem; }
.tag{
  padding:3px 8px; border:1px solid #e2eae7; border-radius:999px; font-size:.82rem; color:#173b32; background:#f5fbf9;
}
.article-card > a.cover{ position:absolute; inset:0; text-indent:-9999px; }
.article-card{ position:relative; }

@media (max-width:640px){ .articles-hero{ padding:28px 0 20px; } }

/* Author page tweaks */
#author-articles.article-grid{
  display:grid; gap:16px;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  align-items:start;
}
#author-articles .article-thumb{ width:100%; aspect-ratio: 16/9; object-fit:cover; display:block; }
#author-articles .article-body{ padding:12px 12px 0; }
#author-articles .article-body h3{ margin:0 0 6px; font-size:1rem; line-height:1.3; }
#author-articles .article-deck{ margin:0; font-size:.92rem; color:#47524e; }
#author-articles .article-meta{ padding:10px 12px 12px; }
#author-articles .meta-left img{ width:24px; height:24px; }
#author-articles .meta-right{ font-size:.86rem; gap:6px; }

/* ========== “How we work” checklist (kept, deduped) ========== */
.grid.two{ display:grid; gap:16px; grid-template-columns: repeat(auto-fit, minmax(260px,1fr)); }
ul.bullets{ margin:0; padding-left:1.1rem; }
ul.bullets li{ margin:.4rem 0; }

.grid.two.checklist{ gap:22px; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); }
.check-item{
  position: relative;
  display: grid;
  grid-template-columns: 22px 1fr;
  grid-template-rows: auto auto;
  column-gap: 12px;
  row-gap: 6px;
  border: 1px solid var(--border);
  border-radius: 14px;
  background: #fff;
  padding: 18px 18px 20px;
  line-height: 1.55;
  box-shadow: var(--shadow);
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease, background .18s ease;
}
.check-item h3{
  grid-column: 2; margin: 0 0 6px 0; font-size: 1.05rem; line-height:1.2;
}
.check-item p{
  grid-column: 2; margin: 0; color: var(--muted);
}
.tick{
  grid-column: 1; grid-row: 1;
  width: 20px; height: 20px; border-radius: 6px;
  border: 1.75px solid var(--border);
  margin-top: 2px; position: relative;
}
.tick::after{
  content:""; position:absolute; left:4px; top:2px; width:11px; height:7px;
  border-left:2px solid currentColor; border-bottom:2px solid currentColor; transform:rotate(-45deg);
}
.check-item:hover, .check-item:focus-within{
  background: var(--accent-soft);
  border-color: var(--accent-border);
  transform: translateY(-1px);
  box-shadow: 0 10px 24px rgba(0,0,0,.08), 0 0 0 1px var(--accent-soft) inset;
}
@media (max-width:640px){
  .grid.two.checklist{ grid-template-columns:1fr; }
}

/* ========== Team grid (kept) ========== */
.team-people{
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 16px;
}
.person{
  display: grid;
  grid-template-rows: auto auto;
  align-content: start;
  gap: 8px;
  padding: 14px;
  background: #fff;
  border: 1px solid var(--border);
  border-radius: 14px;
  box-shadow: var(--shadow);
  text-decoration: none;
  color: inherit;
  transition: transform .16s ease, box-shadow .16s ease, border-color .16s ease, background .16s ease;
}
.person .avatar{
  width: 100%; aspect-ratio: 1 / 1; object-fit: cover;
  border-radius: 10px; border: 1px solid var(--border); background: #f6f6f6; display: block;
}
.person h3{ margin: 2px 0 0; font-size: 1.02rem; line-height: 1.2; }
.person:hover, .person:focus-visible{
  transform: translateY(-1px);
  background: var(--accent-soft);
  border-color: var(--accent-border);
  box-shadow: 0 10px 24px rgba(0,0,0,.08), 0 0 0 1px var(--accent-soft) inset;
}

/* ========== Section rhythm ========== */
.section{ padding:64px 0; }
.section.tight-bottom{ padding-bottom:24px; }

/* Optional logo invert only if you add a white logo asset later */
.page-hero:not(.hero-compact) ~ .site-header .logo img{ filter: none; }

/* Ensure fixed header doesn’t cover anchor targets */
.prose [id], .prose [name] { scroll-margin-top: 84px; }

/* ========== HERO POPUP — canonical (single source of truth) ========== */
.hero-media-frame { position: relative; }

/* Container */
#hero-pop.hero-pop{
  position:absolute;
  top:18px; right:18px; left:auto;
  z-index:5;
  max-width:min(520px, 55vw);
  opacity: 0;
  transform: scale(.96) translateY(-6px);
  transform-origin: top right;
  clip-path: inset(0 0 100% 0 round 16px);
  transition:
    opacity .45s ease,
    transform .45s cubic-bezier(.2,.8,.2,1),
    clip-path .45s ease;
  pointer-events: none;
}
#hero-pop.hero-pop--show{ pointer-events:auto; }
#hero-pop.hero-pop--show:not(.is-collapsed){
  opacity:1;
  transform: scale(1) translateY(0);
  clip-path: inset(0 0 0 0 round 16px);
}

/* Card */
#hero-pop .hero-pop__card{
  display:block;
  background:rgba(10,16,14,.82);
  backdrop-filter:blur(10px);
  -webkit-backdrop-filter:blur(10px);
  border:1px solid rgba(255,255,255,.10);
  border-radius:16px;
  padding:12px 14px 14px;
  box-shadow:0 16px 36px rgba(0,0,0,.35);
  overflow:hidden;
  transition: opacity .35s ease, transform .35s ease;
}

/* App-like opening animation (used when .opening is toggled in JS) */
@keyframes hero-pop-open{
  0%   { opacity:0; transform: translateY(-6px) scale(.96); }
  60%  { opacity:1; transform: translateY(0)    scale(1.02); }
  100% { opacity:1; transform: translateY(0)    scale(1); }
}
#hero-pop.opening .hero-pop__card{
  animation: hero-pop-open .48s cubic-bezier(.22,.61,.36,1);
  transform-origin: top right;
}

/* Titlebar: meta left, pill right, single line with ellipsis */
#hero-pop .hero-pop__titlebar{
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  margin-bottom:8px; white-space:nowrap;
}
#hero-pop .hero-pop__meta-left{
  flex:1; min-width:0; overflow:hidden; text-overflow:ellipsis;
  display:flex; align-items:center; gap:8px;
}
#hero-pop .hero-pop__meta-left .tag,
#hero-pop .hero-pop__meta-left time,
#hero-pop .hero-pop__meta-left span{ white-space:nowrap; }
#hero-pop .hero-pop__meta-left time,
#hero-pop .hero-pop__meta-left span{ font-size:.72rem; color:rgba(234,243,239,.85); }

/* Tag pill in titlebar (higher contrast) */
#hero-pop .hero-pop__meta-left .tag{
  background:#e7fff7; border:1px solid #c3efe2; color:#0e3b30;
  padding:3px 10px; border-radius:999px; font-size:.7rem; font-weight:500;
}

/* Toggle pill (button) */
#hp-toggle.hero-pop__label{
  appearance:none; -webkit-appearance:none;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(255,255,255,.10);
  color:#eaf3ef;
  padding:6px 10px; border-radius:999px;
  font:600 11px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  letter-spacing:.08em; text-transform:uppercase;
  cursor:pointer; white-space:nowrap;
  flex:0 0 auto;           /* don’t shrink */
  z-index:6;               /* above content during fades */
}
#hp-toggle.hero-pop__label:hover{ background:rgba(255,255,255,.16); border-color:rgba(255,255,255,.28); }
#hp-toggle.hero-pop__label:focus-visible{ outline:2px solid rgba(255,255,255,.5); outline-offset:2px; }

/* Content grid: small thumb + text; crossfade only grid, not titlebar */
#hero-pop .hero-pop__grid{
  display:grid; grid-template-columns:72px 1fr; gap:12px; align-items:start;
  opacity:1; transform:none; transition: opacity .35s ease, transform .35s ease;
}
#hero-pop .hero-pop__grid.swap-out{ opacity:0; transform: translateY(6px); }
#hero-pop .hero-pop__thumb{
  width:72px; height:72px; object-fit:cover; border-radius:10px;
  background:#1b2623; border:1px solid rgba(255,255,255,.14);
}
#hero-pop .hero-pop__grid.no-thumb{ grid-template-columns:1fr; }
#hero-pop .hero-pop__grid.no-thumb .hero-pop__thumb{ display:none; }

/* Title/deck */
#hero-pop .hero-pop__title{
  font-family:"Playfair Display", serif;
  font-size:1.05rem; line-height:1.25; margin:0 0 2px; color:#fff;
  overflow:hidden; text-overflow:ellipsis;
}
#hero-pop .hero-pop__deck{
  margin:0; font-size:.92rem; line-height:1.35; color:rgba(234,243,239,.92);
  max-height: 2.7em; overflow:hidden;
}

/* Collapsed state: show only titlebar (meta + pill), hide grid */
#hero-pop.is-collapsed .hero-pop__grid{ display:none; }
#hero-pop.is-collapsed .hero-pop__card{ padding:8px 10px; }

/* Remove link styling inside the card */
#hero-pop .hero-pop__card:link,
#hero-pop .hero-pop__card:visited,
#hero-pop .hero-pop__card:hover,
#hero-pop .hero-pop__card:active{ text-decoration:none; color:inherit; }
#hero-pop .hero-pop__card *{ text-decoration:none; }

/* Mobile adjustments for popup */
@media (max-width:720px){
  #hero-pop{ right:12px; left:12px; top:12px; max-width:none; }
  #hero-pop .hero-pop__grid{ grid-template-columns:56px 1fr; }
  #hero-pop .hero-pop__thumb{ width:56px; height:56px; }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  #hero-pop{
    transition: opacity .1s linear !important;
    transform: none !important;
    clip-path: none !important;
  }
  #hero-pop .hero-pop__card{ animation: none !important; }
}
